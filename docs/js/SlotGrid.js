function ShowSkillSelection(a,b,c){window.SkillCore&&(c=[{label:"Select",cssClass:"btn btn-success",action:function(a){a.Hide();"function"===typeof b&&b(a.GetData("selectedskillid"))}}],a&&c.push({label:"Remove",cssClass:"btn btn-danger",action:function(a){a.Hide();"function"===typeof b&&b(null)}}),c.push({label:"Cancel",cssClass:"btn btn-default",action:function(a){a.Hide();"function"===typeof noCallback&&noCallback()}}),(new Bootstrap4ModalDialog($("#dialogs"),function(a){var c=$("<div>").addClass("container"),
d;for(d in window.SkillCore.ActiveSkillList)window.SkillCore.ActiveSkillList.hasOwnProperty(d)&&window.SkillCore.ActiveSkillList[d].IsVisible()&&window.SkillCore.ActiveSkillList[d].IsAssignable()&&0<window.SkillCore.ActiveSkillList[d].GetCurrentSkillLevel()&&c.append($("<div>").addClass("row").append($("<div>").addClass("col").append($("<button>").attr("type","button").addClass("btn btn-primary btn-block").append($("<div>").addClass(["clickthrough","row","text-noselect"]).append([$("<div>").addClass("col-md-auto").append($("<img>").attr("src",
window.SkillCore.ActiveSkillList[d].GetIconURL())),$("<div>").addClass("col").text(window.SkillCore.ActiveSkillList[d].GetName()),$("<div>").addClass("col col-lg-2").text("Lv: "+window.SkillCore.ActiveSkillList[d].GetCurrentSkillLevel()+"/"+window.SkillCore.ActiveSkillList[d].GetMaxLevel())])))).click(function(b){b.stopPropagation();c.find("button.active").removeClass(["btn-success","active"]).addClass("btn-primary");$(this).find("button").removeClass("btn-primary").addClass("active btn-success");
a.SetData("selectedskillid",$(this).attr("skillid"))}).dblclick(function(c){c.stopPropagation();a.Hide();"function"===typeof b&&b($(this).attr("skillid"))}).attr("skillid",d));return $("<div>").addClass("skill-list-select").append(c)},"Select skill to assign",c)).Show())}function GridInfo(){this.IsEmpty=!0;this.myDiv=this.SkillInfo=null}
GridInfo.prototype.Redraw=function(){this.myDiv&&(this.myDiv.empty(),this.IsEmpty?(this.myDiv.append($("<img>").addClass("clickthrough").attr("src","../skillicons/skillslot_empty_null.png")),this.myDiv.attr("title","Click the box to select skill")):(this.myDiv.append($("<img>").addClass("clickthrough").attr("src",this.SkillInfo.GetIconURL())),this.myDiv.attr("title","Skill: "+this.SkillInfo.GetName()+"\nClick the box to select skill")))};
GridInfo.prototype.resetinfo=function(){this.IsEmpty=!0;this.SkillInfo=null};GridInfo.prototype.SetSkill=function(a){a?(this.IsEmpty=!1,this.SkillInfo=a):this.resetinfo();this.Redraw()};GridInfo.prototype.UnsetSkill=function(){this.SetSkill(null)};
GridInfo.prototype.GetRender=function(){var a=this;this.myDiv=$("<div>").addClass("slotskillimg").click(function(b){b.preventDefault();ShowSkillSelection(!a.IsEmpty,function(b){b?a.SetSkill(window.SkillCore.SkillList[b]):a.UnsetSkill()})});this.IsEmpty||0===this.SkillInfo.GetCurrentSkillLevel()&&this.resetinfo();this.IsEmpty?(this.myDiv.append($("<img>").addClass("clickthrough").attr("src","../skillicons/skillslot_empty_null.png")),this.myDiv.attr("title","Click the box to select skill")):(this.myDiv.append($("<img>").addClass("clickthrough").attr("src",
this.SkillInfo.GetIconURL())),this.myDiv.attr("title","Skill: "+this.SkillInfo.GetName()+"\nClick the box to select skill"));return this.myDiv};function SlotGrid(){this.effect2nd="2_1";this.effect3rd="3_1";this.Column=[];this.Column[0]=this.initRow();this.Column[1]=this.initRow();this.Column[2]=this.initRow();this.Column[3]=this.initRow();this.Column[4]=this.initRow();this.Column[5]=this.initRow()}SlotGrid.prototype.getoption=function(a,b){return $("<option>").val(a).text(b)};
SlotGrid.prototype.initRow=function(){var a=[];a[0]=new GridInfo;a[1]=new GridInfo;a[2]=new GridInfo;return a};SlotGrid.prototype.IsEmptyColumn=function(a){for(var b=0;b<this.Column[a].length;b++)if(!this.GetGridValue(a,b).IsEmpty)return!1;return!0};SlotGrid.prototype.IsEmptyTree=function(){for(var a=0;a<this.Column.length;a++)if(!this.IsEmptyColumn(a))return!1;return!0};SlotGrid.prototype.ResetToEmpty=function(){for(var a=0;a<this.Column[0].length;a++)for(var b=0;b<this.Column.length;b++)this.Column[b][a].UnsetSkill()};
SlotGrid.prototype.GetGridValue=function(a,b){return this.Column[a][b]};SlotGrid.prototype.SetGridValue=function(a,b,c){this.Column[a][b].SetSkill(c)};SlotGrid.prototype.UnsetGridValue=function(a,b){this.Column[a][b].UnsetSkill()};SlotGrid.prototype.printfloor=function(a){for(var b=[],c=0;c<a.length;c++)b.push($("<div>").addClass("col").append(a[c]));return b};SlotGrid.prototype.generatefloor=function(){for(var a=[],b=0;b<this.Column[0].length;b++){a[b]=[];for(var c=0;c<this.Column.length;c++)a[b].push(this.Column[c][b].GetRender())}return a};
SlotGrid.prototype.GetRender=function(){var a=this.generatefloor(),b=this;return $("<div>").append($("<ul>").addClass("liststyle-none").append([$("<li>").append($("<div>").addClass("row").append(this.printfloor(a[0]))),$("<li>").append($("<i>").addClass("fas fa-arrow-up")),$("<li>").append($("<span>").text("Step-3 Bonus: "),$("<select>").attr("id","select3rdchaineffect").append([this.getoption("3_1","Damage +8%"),this.getoption("3_2","Cooldown -15%"),this.getoption("3_3","SG cost -25%")]).val(b.effect3rd).change(function(){b.effect3rd=
$(this).val()})),$("<li>").append($("<i>").addClass("fas fa-arrow-up")),$("<li>").append($("<div>").addClass("row").append(this.printfloor(a[1]))),$("<li>").append($("<i>").addClass("fas fa-arrow-up")),$("<li>").append($("<span>").text("Step-2 Bonus: "),$("<select>").attr("id","select2ndchaineffect").append([this.getoption("2_1","Damage +4%"),this.getoption("2_2","Cooldown -8%"),this.getoption("2_3","SG cost -12%")]).val(b.effect2nd).change(function(){b.effect2nd=$(this).val()})),$("<li>").append($("<i>").addClass("fas fa-arrow-up")),
$("<li>").append($("<div>").addClass("row").append(this.printfloor(a[2]))),$("<li>").append($("<span>").text("(Click the boxes to assign skill)"))]))};
SlotGrid.prototype.ReadAssignment=function(){var a,b=GetUrlParam("s",null);if(b)for(b=b.split("_"),a=0;a<b.length;a++){var c=b[a].split("-");var e=window.SkillCore.GetSkillByShortID(c[2]);e||(e=window.SkillCore.GetSkill(c[2]));e&&!e.IsPassive()&&e.IsVisible()&&!0===e.IsAssignable()&&0<e.GetCurrentSkillLevel()&&this.Column[c[0]][c[1]].SetSkill(e)}c=GetUrlParam("b1",null);a=GetUrlParam("b2",null);c&&(this.effect2nd=c);a&&(this.effect3rd=a)};
SlotGrid.prototype.GenerateAssignment=function(){if(this.IsEmptyTree())return null;for(var a=[],b=0;b<this.Column[0].length;b++)for(var c=0;c<this.Column.length;c++)this.Column[c][b].IsEmpty||(this.Column[c][b].SkillInfo.ShortID?a.push(c+"-"+b+"-"+this.Column[c][b].SkillInfo.ShortID):a.push(c+"-"+b+"-"+this.Column[c][b].SkillInfo.GetID()));return a.join("_")};